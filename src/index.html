<!DOCTYPE html>
<html>
<head>
  <meta charset='utf-8'>
  <meta http-equiv='X-UA-Compatible' content='IE=edge'>
  <meta name='viewport' content='width=device-width, initial-scale=1'>
</head>
<body>

  <my-component message="hello, vue-uhtml"></my-component>

  <!-- Modern Browsers -->
  <script type="module">
    import {
      html,
      defineComponent,
      reactive,
      onBeforeMount,
      onMounted,
      onBeforeUpdate,
      onUpdated,
      onUnmounted,
    } from "./index.esm.js";

    defineComponent({
      name: "my-message",
      props: {
        message: String,
      },
      setup: ({ props }) =>
        () => html`
          <p>
            <span>Message: ${props.message}</span>  
          </p>
        `
    });

    defineComponent({
      name: "my-component",
      setup: ({ emit, props }) => {
        const state = reactive({
          sum: 1,
          message: "hello, vue-uhtml!"
        });

        const add = () => {
          state.sum = state.sum + 1;
          emit(new CustomEvent("add", { detail: state.sum }));
        };

        const oninput = ({ target }) => {
          state.message = target.value;
          emit(new CustomEvent("message", { detail: target.value }));
        };

        onBeforeMount(() => { console.log("my-component: beforeMount") });
        onMounted(() => { console.log("my-component: mounted") });
        onBeforeUpdate(() => { console.log("my-component: beforeUpdate") });
        onUpdated(() => { console.log("my-component: updated") });
        onUnmounted(() => { console.log("my-component: unmounted") });

        return () =>
          html`
            <button onclick=${add}>add</button>
            <p>
              <span>sum: ${state.sum}</span>
            </p>
            <input type="text" oninput=${oninput} value=${state.message}>
            <my-message message=${state.message}></my-message>
          `;
      },
    });
  </script>
  
  <!-- IE 11 Demo -->
  <script src="https://unpkg.com/@webcomponents/webcomponentsjs/webcomponents-bundle.js" nomodule></script>
  <script src="index.legacy.js" nomodule></script>
  <script nomodule>
    VueUhtml.defineComponent({
      name: "my-message",
      props: {
        message: String,
      },
      setup: function(ctx) {
        return function() {
          return VueUhtml.html(
            [
              "<p> <span>Message: ",
              "</span> </p>"
            ],
            ctx.props.message
          );
        }
      }
    });

    VueUhtml.defineComponent({
      name: "my-component",
      props: {
        message: String,
      },
      setup: function(ctx) {
        const state = VueUhtml.reactive({
          sum: 1,
          message: "hello, vue-uhtml!"
        });

        function add() {
          state.sum = state.sum + 1;
          ctx.emit(new CustomEvent("add", { detail: state.sum }));
        };

        function oninput(event) {
          ctx.emit(new CustomEvent("message", { detail: event.target.value }));
          state.message = event.target.value;
        };

        VueUhtml.onBeforeMount(function() { console.log("my-component: beforeMount") });
        VueUhtml.onMounted(function() { console.log("my-component: mounted") });
        VueUhtml.onBeforeUpdate(function() { console.log("my-component: beforeUpdate") });
        VueUhtml.onUpdated(function() { console.log("my-component: updated") });
        VueUhtml.onUnmounted(function() { console.log("my-component: unmounted") });

        return function() {
          return VueUhtml.html(
            [
              "<button onclick=",
              ">add</button> <p> <span>sum: ",
              "</span> </p> <input type='text' oninput=",
              " value=",
              "> <my-message message=",
              "></my-message>"
            ],
            add,
            state.sum,
            oninput,
            state.message,
            state.message
          );
        }
      },
    });
  </script>
</body>
</html>